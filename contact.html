<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link href="img/logo2.png" rel="icon" type="image/jpeg" />
    <title>Contact</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&amp;family=Quicksand:wght@400;500;600&amp;display=swap"
      rel="stylesheet"
    />
    <link href="style/contact.css" rel="stylesheet" />
    <link href="style/style.css" rel="stylesheet" />
    <link href="style/header.css" rel="stylesheet" />
    <link href="style/footer.css" rel="stylesheet" />
  </head>
  <body>
    <div class="bandeau-livraison">
      <div class="bandeau-slider">
        <div class="slide">
          livraison offerte en point relai à partir de 80€ d’achat
        </div>
        <div class="slide">
          Livraison offerte à domicile à partir de 100€ d’achat
        </div>
        <div class="slide">
          livraison offerte en point relai à partir de 80€ d’achat
        </div>
        <div class="slide">
          Livraison offerte à domicile à partir de 100€ d’achat
        </div>
      </div>
    </div>
    <div id="header"></div>
    <main class="contact-wrapper">
      <div class="contact-container">
        <div class="contact-left">
          <section class="contact-card">
            <h1>Nous contacter</h1>
            <p class="intro">
              Une question ? Nous sommes là pour vous répondre !
            </p>
            <form class="contact-form">
              <div class="form-group">
                <label for="nom">Nom</label>
                <input id="nom" name="nom" required="" type="text" />
              </div>
              <div class="form-group">
                <label for="email">Adresse e-mail</label>
                <input id="email" name="email" required="" type="email" />
              </div>
              <div class="form-group">
                <label for="message">Votre message</label>
                <textarea
                  id="message"
                  name="message"
                  required=""
                  rows="6"
                ></textarea>
              </div>
              <button type="submit">Envoyer le message</button>
            </form>
          </section>
        </div>
        <div class="contact-right">
          <h2>Nos coordonnées</h2>
          <p>
            <strong>Email :</strong>
            <a href="mailto:contact@malou.fr">malou.collections@outlook.com</a>
          </p>

          <p>
            <strong>Instagram :</strong>
            <a
              href="https://www.instagram.com/malou.collections/"
              target="_blank"
            >
              <img
                alt="Instagram"
                src="img/icon3.png"
                style="height: 24px; vertical-align: middle"
              />
              malou.collections
            </a>
          </p>
        </div>
      </div>
    </main>
    <div id="footer"></div>
    <script>
      /* =========================================================
   CONTACT – Enhancements non-invasifs
   - Révélation au scroll des cartes (form + coordonnées)
   - Validation légère du formulaire (HTML5 + messages)
   - Auto-resize du textarea
   - Loader sur le bouton d’envoi
   IMPORTANT : ne modifie pas header/footer/bandeau.
   ========================================================= */

      /* Helper: observer d’apparition */
      (function revealOnScroll() {
        const io = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting)
                entry.target.classList.add("is-visible");
            });
          },
          { threshold: 0.12 }
        );

        document
          .querySelectorAll(".contact-card, .contact-right")
          .forEach((el) => io.observe(el));
      })();

      /* Auto-resize du textarea pour éviter la double scrollbar */
      (function autosizeTextarea() {
        const ta = document.querySelector(".contact-form textarea");
        if (!ta) return;
        const fit = () => {
          ta.style.height = "auto";
          ta.style.height = ta.scrollHeight + "px";
        };
        ["input", "change"].forEach((evt) => ta.addEventListener(evt, fit));
        // 1er ajustement
        fit();
      })();

      /* Validation + états visuels + loader */
      (function formEnhance() {
        const form = document.querySelector(".contact-form");
        if (!form) return;
        const submitBtn = form.querySelector('button[type="submit"]');

        // Crée (si besoin) des <small class="error-msg"> sous chaque champ
        form.querySelectorAll(".form-group").forEach((group) => {
          if (!group.querySelector(".error-msg")) {
            const small = document.createElement("small");
            small.className = "error-msg";
            small.textContent = "Ce champ est requis.";
            group.appendChild(small);
          }
        });

        // Utilise l’API Constraint Validation native + styles .is-error
        form.addEventListener("submit", (e) => {
          // Laisse le HTML5 bosser d’abord
          if (!form.checkValidity()) {
            e.preventDefault();

            // Marque les champs invalides visuellement
            form.querySelectorAll(".form-group").forEach((group) => {
              const input = group.querySelector("input, textarea");
              if (!input) return;
              const valid = input.checkValidity();
              group.classList.toggle("is-error", !valid);

              // Message précis si email invalide
              const msg = group.querySelector(".error-msg");
              if (msg && input.type === "email") {
                msg.textContent = input.validity.valueMissing
                  ? "Veuillez renseigner votre email."
                  : input.validity.typeMismatch
                  ? "Adresse e-mail invalide."
                  : "Ce champ est requis.";
              }
            });

            // Scroll au 1er champ en erreur
            const firstError = form.querySelector(".form-group.is-error");
            if (firstError)
              firstError.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
            return;
          }

          // Si tu n’as pas encore d’endpoint, tu peux
          // - laisser l’envoi normal (action/method côté HTML)
          // - ou empêcher l’envoi et simuler un succès (démo)
          // Ici : on montre un loader visuel puis on laisse soumettre normalement
          submitBtn.classList.add("is-loading");
          submitBtn.textContent = "Envoi…";
          // Si tu utilises un service type FormSubmit/Netlify, ne change rien :
          // le submit continuera. Pour un envoi AJAX, empêche le défaut et fais ton fetch().
        });

        // Retire l’état erreur en live quand l’utilisateur corrige
        form.querySelectorAll("input, textarea").forEach((input) => {
          input.addEventListener("input", () => {
            const group = input.closest(".form-group");
            if (group && input.checkValidity())
              group.classList.remove("is-error");
          });
        });
      })();
    </script>

    <script>
      /*
  Fixe les chemins ABSOLUS du header ("/...") quand le site est servi sur GitHub Pages
  dans un sous-dossier (username.github.io/mon-repo/).
  → Préfixe automatiquement "/..." en "/mon-repo/...".
  → Ne fait rien sur un domaine perso (ex: ma-lou.fr) ou en local avec un serveur à la racine.
*/
      (function fixHeaderPathsForGithubPages() {
        // On n'agit QUE si on est sur username.github.io
        if (!location.hostname.endsWith("github.io")) return;

        // Récupère le nom du repo à partir de /<repo>/... dans l'URL
        var parts = location.pathname.split("/").filter(Boolean);
        if (!parts.length) return;
        var REPO = "/" + parts[0]; // ex: "/mon-repo"

        // Fonction utilitaire: préfixe les attributs commençant par "/"
        function prefixAttr(el, attr) {
          if (!el.hasAttribute(attr)) return;
          var val = el.getAttribute(attr);
          if (!val || val[0] !== "/" || val.startsWith(REPO + "/")) return;
          el.setAttribute(attr, REPO + val); // ex: "/img/logo.jpg" -> "/mon-repo/img/logo.jpg"
        }

        // Applique le correctif une fois que le header est injecté
        function applyFix() {
          var root = document.getElementById("header") || document;
          // Liens et images principaux du header
          root
            .querySelectorAll(
              "header a, header img, header source, header link"
            )
            .forEach(function (el) {
              prefixAttr(el, "href");
              prefixAttr(el, "src");
            });
          // (optionnel) corrige aussi les boutons du menu mobile dans le tiroir
          root.querySelectorAll("#mp-drawer a").forEach(function (el) {
            prefixAttr(el, "href");
          });
        }

        // Si le header est injecté en AJAX, on attend son arrivée
        var obs = new MutationObserver(function () {
          if (document.querySelector("#header header")) {
            applyFix();
            obs.disconnect();
          }
        });
        obs.observe(document.documentElement, {
          childList: true,
          subtree: true,
        });

        // Sécurité: si le header est déjà là au moment du chargement du script
        if (document.querySelector("#header header")) {
          applyFix();
          obs.disconnect();
        }
      })();
    </script>

    <script src="script/script.js"></script>
  </body>
</html>
