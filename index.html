<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="img/logo2.png" type="image/jpeg" />

    <title>Ma lou</title>

    <!-- CSS principales : on les laisse en chargement normal (évite FOUC) -->
    <link rel="stylesheet" href="style/style.css" />
    <link rel="stylesheet" href="style/header2.css" />
    <link rel="stylesheet" href="style/footer.css" />
    <link rel="stylesheet" href="style/index.css" />

    <!-- ⚡ Fonts : preconnect + display=swap pour ne pas bloquer le rendu -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Quicksand:wght@400;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- ✅ PRELOAD du LCP (première image du hero).
       ATTENTION : ton script ne génère que jusqu’à 640px.
       Donc on précharge la version JPEG d’origine pour garder une bonne qualité sur desktop. -->
    <link rel="preload" as="image" href="img/hero1.jpg" fetchpriority="high" />

    <style>
      /* Petites règles qui évitent les sauts de mise en page (CLS) et les déformations */

      body {
        background-color: #e8dbcd;
        color: #3f3027;
        font-family: "Quicksand", sans-serif;
      }

      /* Réserve un ratio pour les images de la grille (vignettes mode 3/4) */
      .card {
        display: block;
        border-radius: 0;
        overflow: hidden;
        aspect-ratio: 3/4;
      }
      .card picture,
      .card img {
        width: 100%;
        height: 100%;
        display: block;
      }
      .card img {
        object-fit: cover;
      }

      /* Hero : réserve un ratio pour limiter le CLS */
      .hero-img {
        width: 100%;
        height: auto;
        display: block;
      }
      .hero-img--cover {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      /* Carousel : rien à changer ici pour le perf au démarrage. */
    </style>
  </head>

  <body>
    <div class="bandeau-livraison">
      <div class="bandeau-slider">
        <div class="slide">
          livraison offerte en point relai dès 80€ d’achat
        </div>
        <div class="slide">Livraison offerte à domicile dès 100€ d’achat</div>
        <div class="slide">
          livraison offerte en point relai dès 80€ d’achat
        </div>
        <div class="slide">Livraison offerte à domicile dès 100€ d’achat</div>
      </div>
    </div>

    <!-- Inclusion du header via JS -->
    <div id="header"></div>

    <!-- Section HÉRO avec image pleine largeur/hauteur -->
    <section class="hero reveal">
      <div class="hero-img-wrapper">
        <img src="img/hero1.jpg" alt="Image 1" class="hero-img" />
        <img src="img/hero2.jpg" alt="Image 2" class="hero-img" />
      </div>

      <div class="hero-text">
        <h1>Été 99</h1>
        <a href="été99.html" class="hero-btn">Shop</a>
      </div>
    </section>

    <!-- ===== Carousel Nouvelle Collection (sans scrollbar) ===== -->
    <!-- ===== SECTION ÉTÉ 99 ===== -->
    <!-- ===== SECTION ÉTÉ 99 (pattern A) ===== -->
    <section
      class="collection-grid pattern-a reveal-grid"
      aria-labelledby="t-ete99"
    >
      <h2 id="t-ete99">Été 99</h2>
      <div class="grid">
        <!-- Carte 1 -->
        <a href="été99.html" class="card">
          <picture>
            <!-- WebP légers (320/480/640) : le navigateur choisit la bonne taille -->
            <source
              type="image/webp"
              srcset="
                webp/c1-320.webp 320w,
                webp/c1-480.webp 480w,
                webp/c1-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <!-- Fallback (JPEG/PNG d’origine) pour compatibilité -->
            <img
              src="img/c1.jpg"
              alt="Été 99 - Look 1"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>

        <!-- Carte 2 -->
        <a href="été99.html" class="card">
          <picture>
            <source
              type="image/webp"
              srcset="
                webp/c2-320.webp 320w,
                webp/c2-480.webp 480w,
                webp/c2-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <img
              src="img/c2.jpg"
              alt="Été 99 - Look 2"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>

        <!-- Carte 3 -->
        <a href="été99.html" class="card">
          <picture>
            <source
              type="image/webp"
              srcset="
                webp/c3-320.webp 320w,
                webp/c3-480.webp 480w,
                webp/c3-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <img
              src="img/c3.jpg"
              alt="Été 99 - Look 3"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>

        <!-- Carte 4 -->
        <a href="été99.html" class="card">
          <picture>
            <source
              type="image/webp"
              srcset="
                webp/c4-320.webp 320w,
                webp/c4-480.webp 480w,
                webp/c4-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <img
              src="img/c4.jpg"
              alt="Été 99 - Look 4"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>
      </div>
    </section>

    <!-- ===== SECTION LA RENTRÉE (pattern B = inverse) ===== -->
    <section
      class="collection-grid pattern-b reveal-grid"
      aria-labelledby="t-rentree"
    >
      <h2 id="t-rentree">La rentrée</h2>
      <div class="grid">
        <!-- Carte 1 -->
        <a href="larentré.html" class="card">
          <picture>
            <!-- WebP légers générés par ton script (320/480/640) -->
            <source
              type="image/webp"
              srcset="
                webp/d1-320.webp 320w,
                webp/d1-480.webp 480w,
                webp/d1-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <!-- Fallback : image d'origine (JPEG/PNG) -->
            <img
              src="img/d1.jpg"
              alt="La rentrée - Look 1"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>

        <!-- Carte 2 -->
        <a href="larentré.html" class="card">
          <picture>
            <source
              type="image/webp"
              srcset="
                webp/d2-320.webp 320w,
                webp/d2-480.webp 480w,
                webp/d2-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <img
              src="img/d2.jpg"
              alt="La rentrée - Look 2"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>

        <!-- Carte 3 -->
        <a href="larentré.html" class="card">
          <picture>
            <source
              type="image/webp"
              srcset="
                webp/d3-320.webp 320w,
                webp/d3-480.webp 480w,
                webp/d3-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <img
              src="img/d3.jpg"
              alt="La rentrée - Look 3"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>

        <!-- Carte 4 -->
        <a href="larentré.html" class="card">
          <picture>
            <source
              type="image/webp"
              srcset="
                webp/d4-320.webp 320w,
                webp/d4-480.webp 480w,
                webp/d4-640.webp 640w
              "
              sizes="(max-width: 768px) 50vw, 280px"
            />
            <img
              src="img/d4.jpg"
              alt="La rentrée - Look 4"
              loading="lazy"
              decoding="async"
            />
          </picture>
        </a>
      </div>
    </section>

    <style>
      /* ===== DA site ===== */
      .carousel-section {
        background: #f3e9dc;
        padding: 3rem 1rem;
      }
      .carousel-title {
        font: 700 1.8rem/1 "Inter", sans-serif;
        color: #4e3a2d;
        text-align: center;
        letter-spacing: 1px;
        text-transform: uppercase;
        margin: 0 0 1.2rem;
      }
      .carousel2 {
        position: relative;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 3.5rem;
      }
      .car2-viewport {
        overflow: hidden;
        border-radius: 20px;
      }
      .car2-track {
        display: flex;
        gap: 1.2rem;
        padding: 0 0 0.4rem; /* pas de scroll: on translate en JS */
        will-change: transform;
        transition: transform 0.45s ease;
      }
      /* Carte */
      .car2-item {
        flex: 0 0 clamp(200px, 25vw, 280px);
        aspect-ratio: 3/4;
        border-radius: 18px;
        overflow: hidden;
        background: #efe6d9;
        box-shadow: 0 6px 16px rgba(78, 58, 45, 0.14),
          inset 0 0 0 1px rgba(78, 58, 45, 0.06);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .car2-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        transform: scale(1.02);
        transition: transform 0.35s ease, filter 0.35s ease;
      }
      .car2-item:hover {
        transform: translateY(-4px) scale(1.03);
        box-shadow: 0 12px 28px rgba(78, 58, 45, 0.18),
          0 2px 0 rgba(127, 14, 48, 0.15);
      }
      .car2-item:hover img {
        transform: scale(1.07);
        filter: saturate(1.05) contrast(1.05);
      }

      /* Flèches */
      .car2-btn {
        position: absolute;
        top: 50%;
        translate: 0 -50%;
        width: 40px;
        height: 40px;
        border-radius: 999px;
        border: 1px solid rgba(78, 58, 45, 0.25);
        background: #fff7f0;
        color: #4e3a2d;
        font-size: 22px;
        display: grid;
        place-items: center;
        cursor: pointer;
        box-shadow: 0 6px 14px rgba(78, 58, 45, 0.12);
        transition: transform 0.2s ease, background 0.2s ease;
      }
      .car2-btn:hover {
        background: #f7efe5;
        transform: scale(1.06);
      }
      .car2-prev {
        left: 0.5rem;
      }
      .car2-next {
        right: 0.5rem;
      }
      @media (max-width: 768px) {
        .carousel2 {
          padding: 0 2.2rem;
        }
        .car2-btn {
          width: 34px;
          height: 34px;
          font-size: 18px;
        }
      }
      /* Focus acces */
      .car2-item:focus-visible,
      .car2-btn:focus-visible {
        outline: 3px solid #7f0e30;
        outline-offset: 2px;
      }
    </style>
    <!-- Avantages footer -->
    <div class="footer-benefits-wrap">
      <ul class="footer-benefits">
        <li class="benefit">
          <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
            <path
              d="M3 6h11v7h2.5l2.5-3h2v6h-2a2 2 0 1 1-4 0H9a2 2 0 1 1-4 0H3V6zm14 2v3h1.5l1.5-2h-3z"
            />
          </svg>
          <span class="txt">
            <strong>LIVRAISON RAPIDE</strong>
            <em>Expédition sous 2 à 5 jours ouvrés</em>
          </span>
        </li>

        <li class="benefit">
          <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
            <path
              d="M12 21s-6.7-4.4-9.3-7A5.8 5.8 0 0 1 12 5.3 5.8 5.8 0 0 1 21.3 14c-2.6 2.6-9.3 7-9.3 7z"
            />
          </svg>
          <span class="txt">
            <strong>SATISFAIT OU REMBOURSÉ</strong>
            <em>14 jours pour changer d’avis</em>
          </span>
        </li>

        <li class="benefit">
          <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M4 4h16v10H7l-3 3V4z" />
          </svg>
          <span class="txt">
            <strong>SERVICE CLIENT</strong>
            <em>Nous sommes à votre écoute</em>
          </span>
        </li>

        <li class="benefit">
          <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
            <path
              d="M6 10h12v10H6V10zm2-2a4 4 0 1 1 8 0v2h-2V8a2 2 0 1 0-4 0v2H8V8z"
            />
          </svg>
          <span class="txt">
            <strong>PAIEMENT SÉCURISÉ</strong>
            <em>Carte bancaire & PayPal</em>
          </span>
        </li>
      </ul>
    </div>
    <script>
      /* ===== JS: slide by translateX, pas de scrollbar ===== */
      (() => {
        const track = document.getElementById("car2Track");
        const prev = document.querySelector(".car2-prev");
        const next = document.querySelector(".car2-next");

        let index = 0; // premier item visible
        let perView = 4; // items visibles (calculé)
        let step = 0; // distance en px pour 1 item (calculé)

        function computeLayout() {
          // largeur d'un item + gap
          const first = track.querySelector(".car2-item");
          if (!first) return;
          const style = getComputedStyle(track);
          const gap = parseFloat(style.columnGap || style.gap || 0);
          step = first.getBoundingClientRect().width + gap;

          // combien d'items rentrent dans le viewport ?
          const viewportWidth =
            track.parentElement.getBoundingClientRect().width;
          perView = Math.max(1, Math.floor((viewportWidth + gap) / step));
          clampIndex();
          applyTransform();
        }

        function clampIndex() {
          const maxIndex = Math.max(0, track.children.length - perView);
          if (index > maxIndex) index = maxIndex;
          if (index < 0) index = 0;
        }

        function applyTransform() {
          track.style.transform = `translateX(${-index * step}px)`;
        }

        function go(dir) {
          index += dir;
          clampIndex();
          applyTransform();
        }

        prev.addEventListener("click", () => go(-1));
        next.addEventListener("click", () => go(1));
        window.addEventListener("resize", computeLayout);
        computeLayout();
      })();
    </script>

    <!-- Inclusion du footer via JS -->
    <div id="footer"></div>

    <!-- Script qui charge header/footer -->
    <script>
      console.log("Page chargée !");
      function includeHTML(id, file) {
        fetch(file)
          .then((response) => response.text())
          .then((data) => {
            document.getElementById(id).innerHTML = data;
          });
      }

      includeHTML("header", "header.html");
      includeHTML("footer", "footer.html");

      // Scroll animation pour le header
      function setupScrollHeader() {
        const header = document.querySelector(".main-header");
        window.addEventListener("scroll", () => {
          if (window.scrollY > 50) {
            header.classList.add("scrolled");
          } else {
            header.classList.remove("scrolled");
          }
        });
      }

      // Révélation des sections au scroll
      document.addEventListener("DOMContentLoaded", () => {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("visible");
              } else {
                entry.target.classList.remove("visible");
              }
            });
          },
          { threshold: 0.1 }
        );

        document.querySelectorAll(".reveal").forEach((section) => {
          observer.observe(section);
        });
      });
    </script>

    <script>
      // === Révélation UNIQUEMENT des sections après le hero et avant le footer ===
      // Cible : .carousel-section et .section-texte-images
      document.addEventListener("DOMContentLoaded", () => {
        const sections = [
          ...document.querySelectorAll(
            ".carousel-section, .section-texte-images"
          ),
        ];

        const io = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (!entry.isIntersecting) return;
              entry.target.classList.add("visible");
              io.unobserve(entry.target);
            });
          },
          { threshold: 0.1 }
        );

        // Ajoute .reveal sur chaque section + ses enfants immédiats (stagger léger)
        sections.forEach((section) => {
          // La section elle-même
          section.classList.add("reveal");
          section.style.transitionDelay = "0ms";
          io.observe(section);

          // Ses enfants directs (cartes, images, textes) avec un décalage subtil
          const kids = [...section.children];
          kids.forEach((el, i) => {
            el.classList.add("reveal");
            el.style.transitionDelay = `${Math.min(i * 80, 400)}ms`;
            io.observe(el);
          });
        });
      });
    </script>
    <script>
      /*
  Fixe les chemins ABSOLUS du header ("/...") quand le site est servi sur GitHub Pages
  dans un sous-dossier (username.github.io/mon-repo/).
  → Préfixe automatiquement "/..." en "/mon-repo/...".
  → Ne fait rien sur un domaine perso (ex: ma-lou.fr) ou en local avec un serveur à la racine.
*/
      (function fixHeaderPathsForGithubPages() {
        // On n'agit QUE si on est sur username.github.io
        if (!location.hostname.endsWith("github.io")) return;

        // Récupère le nom du repo à partir de /<repo>/... dans l'URL
        var parts = location.pathname.split("/").filter(Boolean);
        if (!parts.length) return;
        var REPO = "/" + parts[0]; // ex: "/mon-repo"

        // Fonction utilitaire: préfixe les attributs commençant par "/"
        function prefixAttr(el, attr) {
          if (!el.hasAttribute(attr)) return;
          var val = el.getAttribute(attr);
          if (!val || val[0] !== "/" || val.startsWith(REPO + "/")) return;
          el.setAttribute(attr, REPO + val); // ex: "/img/logo.jpg" -> "/mon-repo/img/logo.jpg"
        }

        // Applique le correctif une fois que le header est injecté
        function applyFix() {
          var root = document.getElementById("header") || document;
          // Liens et images principaux du header
          root
            .querySelectorAll(
              "header a, header img, header source, header link"
            )
            .forEach(function (el) {
              prefixAttr(el, "href");
              prefixAttr(el, "src");
            });
          // (optionnel) corrige aussi les boutons du menu mobile dans le tiroir
          root.querySelectorAll("#mp-drawer a").forEach(function (el) {
            prefixAttr(el, "href");
          });
        }

        // Si le header est injecté en AJAX, on attend son arrivée
        var obs = new MutationObserver(function () {
          if (document.querySelector("#header header")) {
            applyFix();
            obs.disconnect();
          }
        });
        obs.observe(document.documentElement, {
          childList: true,
          subtree: true,
        });

        // Sécurité: si le header est déjà là au moment du chargement du script
        if (document.querySelector("#header header")) {
          applyFix();
          obs.disconnect();
        }
      })();
    </script>

    <script>
      /* =========================================================
   IntersectionObserver : ajoute .in-view pour déclencher l’anim
   - cible : toute section .reveal-grid (et ses cartes)
   - une fois visible, on n’observe plus pour éviter de rejouer
   ========================================================= */
      (function setupGridReveal() {
        const sections = document.querySelectorAll(".reveal-grid");
        if (!("IntersectionObserver" in window) || !sections.length) return;

        const io = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (!entry.isIntersecting) return;
              entry.target.classList.add("in-view");
              io.unobserve(entry.target);
            });
          },
          { root: null, rootMargin: "0px 0px -10% 0px", threshold: 0.1 }
        );

        sections.forEach((sec) => io.observe(sec));
      })();
    </script>

    <script src="script/script.js"></script>
  </body>
</html>
