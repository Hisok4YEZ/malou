<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="img/logo2.png" type="image/png" />
    <title>Été 99 – MA LOU</title>

    <!-- Typos DA -->
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Quicksand:wght@400;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Tes feuilles existantes -->
    <link rel="stylesheet" href="style/style.css" />
    <link rel="stylesheet" href="style/header.css" />
    <link rel="stylesheet" href="style/footer.css" />

    <style>
      /* Fond + motif identiques au site */
      :root {
        --rose: #e96878;
        --beige: #e8dbcd;
        --brun: #3f3027;
      }
      body {
        background: #e8dbcd;
        color: #3f3027;
        font-family: "Quicksand", sans-serif;
        margin: 0;
      }
      body.catalogue-bg::before {
        content: "";
        position: fixed;
        inset: 0;
        z-index: -1;
        pointer-events: none;
        background: radial-gradient(
            1200px 800px at 10% -10%,
            rgba(232, 219, 205, 0.55) 0%,
            rgba(232, 219, 205, 0) 60%
          ),
          radial-gradient(
            1200px 800px at 110% 10%,
            rgba(232, 219, 205, 0.45) 0%,
            rgba(232, 219, 205, 0) 60%
          ),
          url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'><g fill='none' stroke='rgba(233,104,120,0.18)' stroke-width='1.2'><circle cx='110' cy='110' r='72'/><path d='M50 90c10-12 30-12 40 0 9 12 9 28 0 40-10 12-30 12-40 0-9-12-9-28 0-40z'/><path d='M130 80c12-10 32-10 44 0 10 10 10 26 0 36-12 10-32 10-44 0-10-10-10-26 0-36z'/></g></svg>");
        background-repeat: repeat;
        background-size: 260px 260px;
        opacity: 0.18;
      }

      /* Bandeau livraison (même composant que tes autres pages) */
      .bandeau-livraison {
        position: sticky;
        top: 0;
        z-index: 30;
        height: 32px;
        background: var(--beige);
        overflow: hidden;
      }
      .bandeau-slider {
        display: flex;
        width: 400%;
        animation: sliderAnim 24s infinite;
      }
      .slide {
        width: 100vw;
        flex-shrink: 0;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        color: #fff;
        letter-spacing: 1.2px;
        text-transform: uppercase;
        font-weight: 500;
      }
      @keyframes sliderAnim {
        0%,
        20% {
          transform: translateX(0);
        }
        25%,
        45% {
          transform: translateX(-100vw);
        }
        50%,
        70% {
          transform: translateX(-200vw);
        }
        75%,
        95% {
          transform: translateX(-300vw);
        }
        100% {
          transform: translateX(0);
        }
      }

      /* Container */
      .collection-container {
        max-width: 1240px;
        margin: 24px auto 80px;
        padding: 0 18px;
      }
      .collection-header {
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
        gap: 16px;
        margin: 6px 0 22px;
        border-left: 6px solid rgba(0, 0, 0, 0.06);
        padding-left: 12px;
      }
      .collection-title {
        font-family: "Cormorant Garamond", serif;
        font-size: 38px;
        line-height: 1.1;
        color: var(--brun);
        margin: 0;
      }
      .collection-count {
        font-size: 14px;
        opacity: 0.7;
      }
    </style>
  </head>

  <body class="catalogue-bg">
    <!-- Bandeau livraison -->
    <div class="bandeau-livraison">
      <div class="bandeau-slider">
        <div class="slide">
          livraison offerte en point relai dès de 80€ d’achat
        </div>
        <div class="slide">
          Livraison offerte à domicile dès de 100€ d’achat
        </div>
        <div class="slide">
          livraison offerte en point relai dès de 80€ d’achat
        </div>
        <div class="slide">
          Livraison offerte à domicile dès de 100€ d’achat
        </div>
      </div>
    </div>

    <!-- Header injecté par ton script -->
    <div id="header"></div>

    <main class="collection-container">
      <div class="collection-header">
        <h1 class="collection-title">Nos produits</h1>
        <div class="collection-count" id="collectionCount">—</div>
      </div>

      <!-- NOEUD Shopify Buy Button (collection) -->
      <div id="collection-component-1754753704786"></div>
    </main>

    <!-- Footer injecté par ton script -->
    <div id="footer"></div>

    <!-- ===== Buy Button SDK + composant collection (100% fonctionnel) ===== -->
    <!-- ===== Buy Button SDK + composant collection (carrousel HD + grid mobile 2x2) ===== -->
    <!-- ===== Buy Button SDK + Composant collection — GRID mobile-first 2x2, fix superposition, images compactes ===== -->
    <!-- ===== Buy Button SDK + Composant collection — 2x2 mobile + images réduites ===== -->
    <script>
      (function () {
        var scriptURL =
          "https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js";

        if (window.ShopifyBuy) {
          window.ShopifyBuy.UI ? ShopifyBuyInit() : loadScript();
        } else {
          loadScript();
        }

        function loadScript() {
          var s = document.createElement("script");
          s.async = true;
          s.src = scriptURL;
          (document.head || document.body).appendChild(s);
          s.onload = ShopifyBuyInit;
        }

        function ShopifyBuyInit() {
          var client = ShopifyBuy.buildClient({
            domain: "eb1iv0-n1.myshopify.com",
            storefrontAccessToken: "5de76971549ee7a5dcb338aaad5e9784",
          });

          ShopifyBuy.UI.onReady(client).then(function (ui) {
            ui.createComponent("collection", {
              id: "677036884342", // ⚠️ ton ID de collection
              node: document.getElementById(
                "collection-component-1754753704786"
              ),
              moneyFormat: "%E2%82%AC%7B%7Bamount_with_comma_separator%7D%7D",
              options: {
                /* === Grille produits === */
                productSet: {
                  styles: {
                    products: {
                      display: "grid",
                      "grid-template-columns": "repeat(2, minmax(0,1fr))", // 2 colonnes par défaut (mobile)
                      gap: "10px",
                      width: "100% !important",
                      margin: "0 !important",
                      padding: "0 !important",
                      "box-sizing": "border-box",
                      overflow: "visible",
                      "grid-auto-rows": "auto",
                      "align-items": "start",

                      "@media (min-width: 768px)": {
                        "grid-template-columns":
                          "repeat(3, minmax(0,1fr)) !important",
                        gap: "14px",
                      },
                      "@media (min-width: 1200px)": {
                        "grid-template-columns":
                          "repeat(4, minmax(0,1fr)) !important",
                        gap: "20px",
                      },
                    },
                  },
                },

                /* === Carte produit === */
                product: {
                  styles: {
                    product: {
                      position: "static !important",
                      float: "none !important",
                      clear: "none !important",
                      display: "flex",
                      "flex-direction": "column",
                      width: "100% !important",
                      "max-width": "100% !important",
                      margin: "0 !important",
                      "box-sizing": "border-box",
                      "text-align": "left",
                      border: "1px solid #eee",
                      "border-radius": "12px",
                      overflow: "hidden",
                      "box-shadow": "0 6px 18px rgba(0,0,0,.04)",
                    },
                    imgWrapper: {
                      width: "100%",
                      "aspect-ratio": "3 / 4", // défaut (desktop/tablette)
                      overflow: "hidden",
                      background: "#f7f5f2",
                    },
                    img: {
                      width: "100%",
                      height: "100%",
                      "object-fit": "cover",
                      display: "block",
                    },
                    title: {
                      "font-family": "Cormorant Garamond, serif",
                      "font-weight": "600",
                      color: "#1f1f1f",
                      "font-size": "18px",
                      margin: "10px 12px 4px",
                    },
                    price: {
                      "font-family": "Quicksand, sans-serif",
                      "font-weight": "700",
                      color: "#333",
                      "font-size": "15px",
                      margin: "0 12px 10px",
                    },
                    button: {
                      "font-family": "Quicksand, sans-serif",
                      "background-color": "#e96878",
                      "border-radius": "0",
                      color: "#fff",
                      margin: "0",
                      width: "100%",
                      border: "none",
                      padding: "10px 0",
                      ":hover": { "background-color": "#000 !important" },
                      ":focus": { "background-color": "#000 !important" },
                    },
                    /* Breakpoints */
                    "@media (max-width: 768px)": {
                      imgWrapper: { "aspect-ratio": "4 / 3" }, // images moins hautes
                      title: { "font-size": "16px", margin: "8px 10px 4px" },
                      price: { "font-size": "14px", margin: "0 10px 8px" },
                    },
                    "@media (max-width: 480px)": {
                      imgWrapper: { "aspect-ratio": "5 / 4" }, // encore moins haut sur très petit écran
                      title: { "font-size": "15px" },
                      price: { "font-size": "13px" },
                    },
                  },
                  buttonDestination: "modal",
                  contents: { options: false },
                  text: { button: "Voir" },
                  googleFonts: ["Cormorant Garamond", "Quicksand"],
                },

                /* === Modale produit === */
                modalProduct: {
                  contents: {
                    img: false,
                    imgWithCarousel: true,
                    button: true,
                    buttonWithQuantity: false,
                  },
                  text: { button: "Ajouter au panier" },
                  styles: {
                    product: { "max-width": "900px" },
                    imgWrapper: { "max-width": "100%" },
                    img: {
                      width: "100%",
                      height: "auto",
                      "object-fit": "contain",
                    },
                  },
                },

                /* === Panier === */
                toggle: {
                  styles: {
                    toggle: {
                      "background-color": "#000",
                      ":hover": { "background-color": "#000" },
                      ":focus": { "background-color": "#000" },
                    },
                  },
                },
                cart: {
                  styles: {
                    button: {
                      "background-color": "#000",
                      ":hover": { "background-color": "#000" },
                      ":focus": { "background-color": "#000" },
                    },
                  },
                  text: {
                    title: "Panier",
                    total: "Total",
                    empty: "Votre panier est vide 🥲",
                    notice:
                      "Les codes d'expédition et de réduction sont ajoutés lors du paiement.",
                    button: "Payer",
                  },
                },
              }, // fin options
            }).then(function () {
              setTimeout(function () {
                try {
                  var iframe = document.querySelector(
                    "#collection-component-1754753704786 iframe"
                  );
                  if (!iframe || !iframe.contentDocument) return;
                  var doc = iframe.contentDocument;

                  /* Fix layout dans l'iframe (empêche superpositions) */
                  var fixLayout = doc.createElement("style");
                  fixLayout.textContent = `
              .shopify-buy__product,
              .shopify-buy__product-wrapper,
              .shopify-buy__product__content {
                position: static !important;
                float: none !important;
                clear: none !important;
              }
              .shopify-buy__collection,
              .shopify-buy__product-set,
              .shopify-buy__product-set .products {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                box-sizing: border-box !important;
                overflow: visible !important;
              }
              .shopify-buy__product img {
                max-width: 100% !important;
                height: auto !important;
                display: block !important;
              }
            `;
                  doc.head.appendChild(fixLayout);
                } catch (e) {
                  console.warn("Injection iframe échouée :", e);
                }
              }, 700);
            });
          });
        }
      })();
    </script>

    <script>
      /*
  Fixe les chemins ABSOLUS du header ("/...") quand le site est servi sur GitHub Pages
  dans un sous-dossier (username.github.io/mon-repo/).
  → Préfixe automatiquement "/..." en "/mon-repo/...".
  → Ne fait rien sur un domaine perso (ex: ma-lou.fr) ou en local avec un serveur à la racine.
*/
      (function fixHeaderPathsForGithubPages() {
        // On n'agit QUE si on est sur username.github.io
        if (!location.hostname.endsWith("github.io")) return;

        // Récupère le nom du repo dès de /<repo>/... dans l'URL
        var parts = location.pathname.split("/").filter(Boolean);
        if (!parts.length) return;
        var REPO = "/" + parts[0]; // ex: "/mon-repo"

        // Fonction utilitaire: préfixe les attributs commençant par "/"
        function prefixAttr(el, attr) {
          if (!el.hasAttribute(attr)) return;
          var val = el.getAttribute(attr);
          if (!val || val[0] !== "/" || val.startsWith(REPO + "/")) return;
          el.setAttribute(attr, REPO + val); // ex: "/img/logo.jpg" -> "/mon-repo/img/logo.jpg"
        }

        // Applique le correctif une fois que le header est injecté
        function applyFix() {
          var root = document.getElementById("header") || document;
          // Liens et images principaux du header
          root
            .querySelectorAll(
              "header a, header img, header source, header link"
            )
            .forEach(function (el) {
              prefixAttr(el, "href");
              prefixAttr(el, "src");
            });
          // (optionnel) corrige aussi les boutons du menu mobile dans le tiroir
          root.querySelectorAll("#mp-drawer a").forEach(function (el) {
            prefixAttr(el, "href");
          });
        }

        // Si le header est injecté en AJAX, on attend son arrivée
        var obs = new MutationObserver(function () {
          if (document.querySelector("#header header")) {
            applyFix();
            obs.disconnect();
          }
        });
        obs.observe(document.documentElement, {
          childList: true,
          subtree: true,
        });

        // Sécurité: si le header est déjà là au moment du chargement du script
        if (document.querySelector("#header header")) {
          applyFix();
          obs.disconnect();
        }
      })();
    </script>

    <!-- Ton script global (injection header/footer, etc.) -->
    <script src="script/script.js"></script>
  </body>
</html>
